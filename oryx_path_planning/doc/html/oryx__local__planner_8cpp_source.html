<title>oryx_path_planning: oryx_local_planner.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">oryx_local_planner.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="oryx__local__planner_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">//*********************** SYSTEM DEPENDENCIES ************************************//</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include&lt;queue&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include&lt;actionlib/client/simple_action_client.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include&lt;oryx_drive_controller/VelocityCommandAction.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include&lt;boost/lexical_cast.hpp&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include&lt;boost/circular_buffer.hpp&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include&lt;oryx_msgs/SoftwareStop.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include&lt;geometry_msgs/Twist.h&gt;</span>
<a name="l00016"></a>00016 <span class="comment">//*********************** LOCAL DEPENDENCIES ************************************//</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="OryxPathPlanning_8h.html" title="Contains all of the Includes required to complete the oryx_path_planning namespace.">OryxPathPlanning.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;OryxPathPlannerConfig.h&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;oryx_path_planning/OccupancyGridMsg.h&quot;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="comment">//*********************** MACROS ************************************//</span>
<a name="l00023"></a><a class="code" href="oryx__local__planner_8cpp.html#a0c63390af22aa0f877eece67372a7414">00023</a> <span class="comment"></span><span class="preprocessor">#define CONNECTION_TIMEOUT      5.0</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="keyword">using namespace </span>oryx_path_planning;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">//*********************** HELPER CLASS DEFINITIONS ******************************//</span>
<a name="l00028"></a>00028 
<a name="l00033"></a><a class="code" href="classLocalPlanner.html">00033</a> <span class="keyword">class </span><a class="code" href="classLocalPlanner.html" title="Class which does the actual work of local path planning and sending commands to base.">LocalPlanner</a>
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035 <span class="keyword">public</span>:
<a name="l00055"></a><a class="code" href="classLocalPlanner.html#a93af54d6907d8691ba72f009b1f6195e">00055</a>         <a class="code" href="classLocalPlanner.html" title="Class which does the actual work of local path planning and sending commands to base.">LocalPlanner</a>(<span class="keywordtype">int</span> platform, <span class="keywordtype">double</span> goalWeight, <span class="keywordtype">double</span> travWeight, <span class="keywordtype">double</span> diffWeight, <span class="keywordtype">double</span> unknWeight, <span class="keywordtype">double</span> xDim, <span class="keywordtype">double</span> yDim, <span class="keywordtype">double</span> zDim, <span class="keywordtype">double</span> res, <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a>&amp; origin, std::string&amp; v_action_topic, std::string&amp; oc_point_cloud_topic, <a class="code" href="namespaceoryx__path__planning.html#a31e90111442c09b8e17c0bc6a3eb98e7" title="Typedef to allow for convenient sharing of a TentacleGenerator via pointer.">TentacleGeneratorPtr</a> tentacles) <span class="keywordflow">throw</span>(std::runtime_error):
<a name="l00056"></a>00056                 v_action_topic_(v_action_topic),
<a name="l00057"></a>00057                 pc_topic_(oc_point_cloud_topic),
<a name="l00058"></a>00058                 origin_(origin),
<a name="l00059"></a>00059                 tentacles_(tentacles),
<a name="l00060"></a>00060                 occupancy_buffer_(2),
<a name="l00061"></a>00061                 v_client_(v_action_topic, <span class="keyword">true</span>)
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063                 this-&gt;platform_    = platform;
<a name="l00064"></a>00064                 this-&gt;goal_weight_ = goalWeight;
<a name="l00065"></a>00065                 this-&gt;trav_weight_ = travWeight;
<a name="l00066"></a>00066                 this-&gt;diff_weight_ = diffWeight;
<a name="l00067"></a>00067                 this-&gt;unkn_weight_ = unknWeight;
<a name="l00068"></a>00068                 this-&gt;x_dim_ = xDim;
<a name="l00069"></a>00069                 this-&gt;y_dim_ = yDim;
<a name="l00070"></a>00070                 this-&gt;z_dim_ = zDim;
<a name="l00071"></a>00071                 this-&gt;res_  = res;
<a name="l00072"></a>00072                 this-&gt;pc_sub_ = nh_.subscribe(this-&gt;pc_topic_, 1, &amp;<a class="code" href="classLocalPlanner.html#af5e5b35b455967277af17dcb6b09fb3b" title="Callback for processing new point cloud data.">LocalPlanner::pcCB</a>, <span class="keyword">this</span>);
<a name="l00073"></a>00073                 this-&gt;should_plan_ = <span class="keyword">true</span>;
<a name="l00074"></a>00074                 this-&gt;current_rad_ = 0;
<a name="l00075"></a>00075                 this-&gt;current_vel_ = 0;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077                 std::string software_stop_topic(<span class="stringliteral">&quot;oryx/software_stop&quot;</span>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079                 <span class="keywordflow">if</span>(!this-&gt;nh_.getParam(software_stop_topic, software_stop_topic))ROS_WARN(<span class="stringliteral">&quot;%s not set, using default value %s&quot;</span>, software_stop_topic.c_str(), software_stop_topic.c_str());
<a name="l00080"></a>00080                 this-&gt;stop_sub_ = nh_.subscribe(software_stop_topic, 1, &amp;<a class="code" href="classLocalPlanner.html#a80d9e4db91908f43ed4c062b64bc026a" title="The actionlib client to set velocity command messages to the base platform with.">LocalPlanner::stopCB</a>, <span class="keyword">this</span>);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082                 <span class="keywordflow">switch</span>(this-&gt;platform_)
<a name="l00083"></a>00083                 {
<a name="l00084"></a>00084                 <span class="keywordflow">case</span> 0:
<a name="l00085"></a>00085                         ROS_INFO(<span class="stringliteral">&quot;Waiting For Connection To Velocity Control Server On &lt;%s&gt;...&quot;</span>, this-&gt;v_action_topic_.c_str());
<a name="l00086"></a>00086                         <span class="keywordflow">if</span>(v_client_.waitForServer(ros::Duration(<a class="code" href="oryx__local__planner_8cpp.html#a0c63390af22aa0f877eece67372a7414" title="Number of seconds to wait for connections to other ROS nodes before determining a system failure...">CONNECTION_TIMEOUT</a>)))
<a name="l00087"></a>00087                         {
<a name="l00088"></a>00088                                 ROS_INFO(<span class="stringliteral">&quot;Connection Established&quot;</span>);
<a name="l00089"></a>00089                         }
<a name="l00090"></a>00090                         <span class="keywordflow">else</span>
<a name="l00091"></a>00091                         {
<a name="l00092"></a>00092                                 ROS_ERROR(<span class="stringliteral">&quot;Could Not Establish Connection To Velocity Control Server!&quot;</span>);
<a name="l00093"></a>00093                                 std::string errMsg(<span class="stringliteral">&quot;Unable to connect to velocity command server over &quot;</span>);
<a name="l00094"></a>00094                                 <span class="keywordflow">throw</span> std::runtime_error(errMsg+this-&gt;v_action_topic_);
<a name="l00095"></a>00095                         }
<a name="l00096"></a>00096                         <span class="keywordflow">break</span>;
<a name="l00097"></a>00097                 <span class="keywordflow">case</span> 1:
<a name="l00098"></a>00098                         ROS_INFO_STREAM(<span class="stringliteral">&quot;Publishing Twists to &lt;&quot;</span>&lt;&lt;this-&gt;v_action_topic_&lt;&lt;<span class="stringliteral">&quot;&gt;&quot;</span>);
<a name="l00099"></a>00099                         this-&gt;vel_pub_ = this-&gt;nh_.advertise&lt;geometry_msgs::Twist&gt;(this-&gt;v_action_topic_, 2);
<a name="l00100"></a>00100                         <span class="keywordflow">break</span>;
<a name="l00101"></a>00101                 <span class="keywordflow">default</span>:
<a name="l00102"></a>00102                         ROS_FATAL(<span class="stringliteral">&quot;Unkown Platform, Could Not Setup Local Planner&quot;</span>);
<a name="l00103"></a>00103                         <span class="keywordflow">break</span>;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105                 }
<a name="l00106"></a>00106                 ROS_INFO(<span class="stringliteral">&quot;Oryx Local Planner Running&quot;</span>);
<a name="l00107"></a>00107 }
<a name="l00111"></a><a class="code" href="classLocalPlanner.html#a3cd8fe2ad521379c1adb801202fef62d">00111</a>         <span class="keyword">virtual</span> <a class="code" href="classLocalPlanner.html#a3cd8fe2ad521379c1adb801202fef62d">~LocalPlanner</a>(){};
<a name="l00112"></a>00112 
<a name="l00118"></a><a class="code" href="classLocalPlanner.html#a5e5de9ddb98611ea99329b8ef295c7c4">00118</a>         <span class="keywordtype">void</span> doPlanning()
<a name="l00119"></a>00119         {
<a name="l00120"></a>00120                 <a class="code" href="classoryx__path__planning_1_1Tentacle.html" title="Container class for holding data about a tentacle.">Tentacle</a> zero_tentacle(0,0,0,0,0,0,0,0,0);
<a name="l00121"></a>00121                 <span class="keywordtype">double</span> current_radius = std::numeric_limits&lt;double&gt;::infinity();
<a name="l00122"></a>00122                 <span class="keywordtype">double</span> current_velocity = 0;
<a name="l00123"></a>00123                 <span class="keywordflow">while</span>(ros::ok())
<a name="l00124"></a>00124                 {
<a name="l00125"></a>00125                         <span class="keywordflow">if</span>(should_plan_)
<a name="l00126"></a>00126                         {
<a name="l00127"></a>00127                                 <span class="comment">//Grab the next occupancy grid to process</span>
<a name="l00128"></a>00128                                 <span class="keywordflow">if</span>(!this-&gt;occupancy_buffer_.empty())
<a name="l00129"></a>00129                                 {
<a name="l00130"></a>00130                                         <a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html" title="Class which represents an Occupancy Grid that contains data on the robot&#39;s local frame.">OccupancyGrid</a>   working_grid= this-&gt;occupancy_buffer_.front();
<a name="l00131"></a>00131                                         <a class="code" href="classoryx__path__planning_1_1SpeedSet.html" title="Container class for holding tentacle data for a speed set.">SpeedSet</a>                speed_set   = this-&gt;tentacles_-&gt;getSpeedSet(this-&gt;current_vel_);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133                                         ROS_INFO(<span class="stringliteral">&quot;I&#39;m Processing The Following Occupancy Grid:\n%s&quot;</span>, working_grid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#a8753688af5e3a1a1f1b00453c96da801" title="Generates a string representation of a slice of the Occupancy Grid.">toString</a>(0,0).get()-&gt;c_str());
<a name="l00134"></a>00134                                         <span class="keywordtype">int</span> num_points = 0;
<a name="l00135"></a>00135                                         <span class="keywordflow">for</span>(<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#a19ff15df98710c66a94f4611b8a3b5f5" title="Typedef to make iterators easier.">OccupancyGrid::iterator</a> test_itr = working_grid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#aa651dc3bd941abb4fdecdb8c78b6a6d0">begin</a>(); test_itr&lt;working_grid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#a9804fe713c0cb384fd694221172fe411">end</a>(); test_itr++)
<a name="l00136"></a>00136                                         {
<a name="l00137"></a>00137                                                 <span class="comment">//ROS_INFO_COND(test_itr-&gt;rgba != oryx_path_planning::FREE_LOW_COST, &quot;Found an obsticale point! &lt;%f, %f&gt;&quot;, test_itr-&gt;x, test_itr-&gt;y);</span>
<a name="l00138"></a>00138                                                 <span class="keywordflow">if</span>(test_itr-&gt;rgba != <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaafe6e721441d3581cac8f1eba2d7efd5b" title="FREE_LOW_COST Point on the grid is free but is easy to travel over (Green)">oryx_path_planning::FREE_LOW_COST</a>)num_points++;
<a name="l00139"></a>00139                                         }
<a name="l00140"></a>00140                                         ROS_INFO(<span class="stringliteral">&quot;I Found %d number of interesting points&quot;</span>, num_points);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a>00144                                         ROS_INFO(<span class="stringliteral">&quot;I&#39;m Going To Use A Speed Set With The Parameters &lt;NumTent:%d, Vel:%f, SR:%f&gt;&quot;</span>, speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#a1d71e3cc06200c8812493f4c03a3ec9c" title="Gets the number of tentacles in the SpeedSet.">getNumTentacle</a>(), speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#aaa791367923ecfab3818cbaaf389fcfe" title="Gets the velocity of this SpeedSet.">getVelocity</a>(), speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#ac933999233ee347fcd31aee0eed71ff0" title="Gets the seed radius of this SpeedSet.">getSeedRad</a>());
<a name="l00145"></a>00145                                         <a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html" title="Class which represents an Occupancy Grid that contains data on the robot&#39;s local frame.">OccupancyGrid</a> rendering(working_grid);
<a name="l00146"></a>00146                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> longest_index = 0;
<a name="l00147"></a>00147                                         <span class="keywordtype">double</span> longest_length = 0;
<a name="l00148"></a>00148                                         <span class="keywordtype">double</span> length_modifier = 0;
<a name="l00149"></a>00149                                         <span class="keywordtype">bool</span>   has_goal      = <span class="keyword">true</span>;
<a name="l00150"></a>00150                                         ROS_INFO(<span class="stringliteral">&quot;I&#39;m looking for the longest tentacle...&quot;</span>);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#a1d71e3cc06200c8812493f4c03a3ec9c" title="Gets the number of tentacles in the SpeedSet.">getNumTentacle</a>(); i++)
<a name="l00153"></a>00153                                         {
<a name="l00154"></a>00154                                                 <span class="keywordtype">bool</span> traversing = <span class="keyword">true</span>;
<a name="l00155"></a>00155                                                 <span class="keywordtype">bool</span> hit_goal   = <span class="keyword">false</span>;
<a name="l00156"></a>00156                                                 <a class="code" href="classoryx__path__planning_1_1Tentacle.html" title="Container class for holding data about a tentacle.">Tentacle</a> working_tentacle = speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#ac447ac3fe219c6e44c9729fe587d4911" title="Gets a Tentacle from the speed set.">getTentacle</a>(i);
<a name="l00157"></a>00157                                                 <a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html" title="Helper class for traversing an oryx_path_planning::Tentacle.">Tentacle::TentacleTraverser</a> traverser(working_tentacle);
<a name="l00158"></a>00158                                                 length_modifier = 0;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160                                                 <span class="comment">//As long as the tentacle has points still, and we&#39;re still traversing, continue traversing</span>
<a name="l00161"></a>00161                                                 <span class="keywordflow">while</span>(traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a1a61ea2ccdcbb4b9548b62ac3204b8ab" title="Returns true if there are points left in the traversal.">hasNext</a>()&amp;&amp;traversing)
<a name="l00162"></a>00162                                                 {
<a name="l00163"></a>00163                                                         <span class="keyword">const</span> <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a>&amp; point = traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a7df2a616360d9a5e54456d81e006be66" title="Gets the next point in the traversal.">next</a>();
<a name="l00164"></a>00164                                                         <span class="keywordflow">try</span>
<a name="l00165"></a>00165                                                         {
<a name="l00166"></a>00166                                                                 <span class="keywordflow">switch</span>(working_grid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#a7ad9a664e4f37b14f936c4039f3263ed" title="Gets the PointTrait of a given point on the grid.">getPointTrait</a>(point))
<a name="l00167"></a>00167                                                                 {
<a name="l00168"></a>00168                                                                 <span class="keywordflow">case</span> <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaaf266fa3c415ede078bf2d830262923c7" title="OBSTACLE Point on the grid contains an obstacle (Red)">oryx_path_planning::OBSTACLE</a>:
<a name="l00169"></a>00169                                                                         ROS_INFO(<span class="stringliteral">&quot;Hit Obstacle On Tentacle %d at length %f&quot;</span>, i, traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a901c73f8c9ca8cc3a2ac2f73f793bf16" title="Gets the length traversed thus far along the Tentacle.">lengthTraversed</a>());
<a name="l00170"></a>00170                                                                         PRINT_POINT(<span class="stringliteral">&quot;Hit Point&quot;</span>, point);
<a name="l00171"></a>00171                                                                         traversing = <span class="keyword">false</span>;
<a name="l00172"></a>00172                                                                         <span class="keywordflow">break</span>;
<a name="l00173"></a>00173                                                                 <span class="keywordflow">case</span> <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaa5e0a13cf60b1c0f29efa8723df51180b" title="GOAL Point on the grid is the goal position (Yellow)">oryx_path_planning::GOAL</a>:
<a name="l00174"></a>00174                                                                         ROS_INFO(<span class="stringliteral">&quot;Hit the Goal on Tentacle %d at length %f&quot;</span>, i, traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a901c73f8c9ca8cc3a2ac2f73f793bf16" title="Gets the length traversed thus far along the Tentacle.">lengthTraversed</a>());
<a name="l00175"></a>00175                                                                         traversing = <span class="keyword">false</span>;
<a name="l00176"></a>00176                                                                         hit_goal   = <span class="keyword">true</span>;
<a name="l00177"></a>00177                                                                         <span class="keywordflow">break</span>;
<a name="l00178"></a>00178                                                                 <span class="keywordflow">case</span> <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaa0f9faea43a80c6e18c341a53350c8167" title="FREE_HIGH_COST Point on the grid is free but is expensive to travel over (Teal)">oryx_path_planning::FREE_HIGH_COST</a>:
<a name="l00179"></a>00179                                                                         length_modifier -= traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#aa34b8ee82f9a95c1ffb6fff8ba995f6c" title="Gets the distance traversed between the last two points.">deltaLength</a>()*this-&gt;diff_weight_;
<a name="l00180"></a>00180                                                                         <span class="keywordflow">break</span>;
<a name="l00181"></a>00181                                                                 <span class="keywordflow">case</span> <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaa866eda2eb7a2f9be1cedda22cae57425" title="TRAVERSED Point on the grid is free but has been previously traversed (Olive Drab)">oryx_path_planning::TRAVERSED</a>:
<a name="l00182"></a>00182                                                                         length_modifier -= traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#aa34b8ee82f9a95c1ffb6fff8ba995f6c" title="Gets the distance traversed between the last two points.">deltaLength</a>()*this-&gt;trav_weight_;
<a name="l00183"></a>00183                                                                         <span class="keywordflow">break</span>;
<a name="l00184"></a>00184                                                                 <span class="keywordflow">case</span> <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaa48198235f7acab8c48f1377be873e02d" title="UNKNOWN Point on the grid is unknown (Grey)">oryx_path_planning::UNKNOWN</a>:
<a name="l00185"></a>00185                                                                         length_modifier += traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#aa34b8ee82f9a95c1ffb6fff8ba995f6c" title="Gets the distance traversed between the last two points.">deltaLength</a>()*this-&gt;unkn_weight_;
<a name="l00186"></a>00186                                                                         <span class="keywordflow">break</span>;
<a name="l00187"></a>00187                                                                 <span class="keywordflow">default</span>:
<a name="l00188"></a>00188                                                                         <span class="keywordflow">break</span>;
<a name="l00189"></a>00189                                                                 }
<a name="l00190"></a>00190                                                         }<span class="keywordflow">catch</span>(<a class="code" href="classoryx__path__planning_1_1OccupancyGridAccessException.html" title="Basic exception for stating that an invalid location on the occupancy grid was accessed.">OccupancyGridAccessException</a>&amp; e)
<a name="l00191"></a>00191                                                         {
<a name="l00192"></a>00192                                                                 ROS_ERROR(<span class="stringliteral">&quot;%s&quot;</span>, e.what());
<a name="l00193"></a>00193                                                         }
<a name="l00194"></a>00194                                                 }
<a name="l00195"></a>00195                                                 ROS_INFO_STREAM(<span class="stringliteral">&quot;I&#39;m Checking The Distance To Goal&quot;</span>);
<a name="l00196"></a>00196                                                 <span class="comment">//Modify length based on closeness to goal, if there is one</span>
<a name="l00197"></a>00197                                                 <span class="keywordflow">if</span>(has_goal)
<a name="l00198"></a>00198                                                 {
<a name="l00199"></a>00199                                                         ROS_INFO_STREAM(<span class="stringliteral">&quot;There is a goal...&quot;</span>);
<a name="l00200"></a>00200                                                         <span class="keywordflow">try</span>
<a name="l00201"></a>00201                                                         {
<a name="l00202"></a>00202                                                                 <span class="comment">//Will throw false if there was no goal point</span>
<a name="l00203"></a>00203                                                                 <span class="keyword">const</span> <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a> goal_point = working_grid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#af397fd5df98be452cb3d2d827a65f74c">getGoalPoint</a>();
<a name="l00204"></a>00204                                                                 <span class="keyword">const</span> <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a> end_point = traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a7df2a616360d9a5e54456d81e006be66" title="Gets the next point in the traversal.">next</a>();
<a name="l00205"></a>00205                                                                 <span class="keywordtype">double</span> dist_to_goal = pcl::distances::l2(end_point.getVector4fMap(), goal_point.getVector4fMap());
<a name="l00206"></a>00206                                                                 ROS_INFO_STREAM(<span class="stringliteral">&quot;Distance To Goal: &quot;</span>&lt;&lt;dist_to_goal);
<a name="l00207"></a>00207                                                                 length_modifier-= dist_to_goal*this-&gt;goal_weight_;
<a name="l00208"></a>00208                                                         }
<a name="l00209"></a>00209                                                         <span class="keywordflow">catch</span>(<span class="keywordtype">bool</span>&amp; e)
<a name="l00210"></a>00210                                                         {
<a name="l00211"></a>00211                                                                 ROS_INFO(<span class="stringliteral">&quot;There is not a goal&quot;</span>);
<a name="l00212"></a>00212                                                                 <span class="comment">//There was no goal, set the flag</span>
<a name="l00213"></a>00213                                                                 has_goal = e;
<a name="l00214"></a>00214                                                         }
<a name="l00215"></a>00215                                                 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217                                                 <span class="comment">//Check to see if the current tentacle is the best one</span>
<a name="l00218"></a>00218                                                 <span class="keywordflow">if</span>(traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a901c73f8c9ca8cc3a2ac2f73f793bf16" title="Gets the length traversed thus far along the Tentacle.">lengthTraversed</a>()+length_modifier &gt;= (longest_length))
<a name="l00219"></a>00219                                                 {
<a name="l00220"></a>00220                                                         longest_index = i;
<a name="l00221"></a>00221                                                         longest_length = traverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a901c73f8c9ca8cc3a2ac2f73f793bf16" title="Gets the length traversed thus far along the Tentacle.">lengthTraversed</a>();
<a name="l00222"></a>00222                                                         <span class="comment">//if we hit the goal, break out of the tentacle search</span>
<a name="l00223"></a>00223                                                         <span class="keywordflow">if</span>(hit_goal) <span class="keywordflow">break</span>;
<a name="l00224"></a>00224                                                 }
<a name="l00225"></a>00225                                         }
<a name="l00226"></a>00226                                         <span class="comment">//Update the current radius and velocity</span>
<a name="l00227"></a>00227                                         current_radius   = speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#ac447ac3fe219c6e44c9729fe587d4911" title="Gets a Tentacle from the speed set.">getTentacle</a>(longest_index).<a class="code" href="classoryx__path__planning_1_1Tentacle.html#af385a2636043fe97b0495c71677233f0" title="gets The radius data of the tentacle">getRad</a>();
<a name="l00228"></a>00228                                         current_velocity = speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#ac447ac3fe219c6e44c9729fe587d4911" title="Gets a Tentacle from the speed set.">getTentacle</a>(longest_index).<a class="code" href="classoryx__path__planning_1_1Tentacle.html#aabe1ab287cbcdcb11a24831606429b70" title="Gets the velocity data of the tentacle.">getVel</a>();
<a name="l00229"></a>00229                                         <span class="comment">//Print out the selected tentacle on the grid</span>
<a name="l00230"></a>00230                                         ROS_INFO(<span class="stringliteral">&quot;I Selected Tentacle %d, length %f&quot;</span>, longest_index, longest_length);
<a name="l00231"></a>00231                                         <a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html" title="Helper class for traversing an oryx_path_planning::Tentacle.">Tentacle::TentacleTraverser</a> overlayTraverser(speed_set.<a class="code" href="classoryx__path__planning_1_1SpeedSet.html#ac447ac3fe219c6e44c9729fe587d4911" title="Gets a Tentacle from the speed set.">getTentacle</a>(longest_index));
<a name="l00232"></a>00232                                         <span class="keywordflow">while</span>(overlayTraverser.hasNext())
<a name="l00233"></a>00233                                         {
<a name="l00234"></a>00234                                                 <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a> point = overlayTraverser.<a class="code" href="classoryx__path__planning_1_1Tentacle_1_1TentacleTraverser.html#a7df2a616360d9a5e54456d81e006be66" title="Gets the next point in the traversal.">next</a>();
<a name="l00235"></a>00235                                                 <span class="keywordflow">try</span>
<a name="l00236"></a>00236                                                 {
<a name="l00237"></a>00237                                                         rendering.setPointTrait(point, <a class="code" href="namespaceoryx__path__planning.html#a4d4dae29f743adb3cb1f7c657a6d15eaa6f74f5fce8cc8b4c21bf425ed95f37bb" title="TENTACLE Point on the grid is a Tentacle marker (Pink)">oryx_path_planning::TENTACLE</a>);
<a name="l00238"></a>00238                                                 }<span class="keywordflow">catch</span>(std::exception&amp; e){
<a name="l00239"></a>00239                                                         ROS_ERROR(<span class="stringliteral">&quot;%s&quot;</span>, e.what());
<a name="l00240"></a>00240                                                 }
<a name="l00241"></a>00241                                         }
<a name="l00242"></a>00242                                         ROS_INFO(<span class="stringliteral">&quot;This Is The Occupancy Grid With Selected Tentacle Overlaid:\n%s&quot;</span>, rendering.toString(0,0)-&gt;c_str());
<a name="l00243"></a>00243                                         this-&gt;occupancy_buffer_.pop_front();
<a name="l00244"></a>00244                                 }
<a name="l00245"></a>00245                                 <span class="comment">//Send the velocity command to the platform</span>
<a name="l00246"></a>00246                                 sendVelCom(current_radius, current_velocity);
<a name="l00247"></a>00247                         }
<a name="l00248"></a>00248                         <span class="comment">//spin to let ROS process callbacks</span>
<a name="l00249"></a>00249                         ros::spinOnce();
<a name="l00250"></a>00250                 }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253 <span class="keyword">private</span>:
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="classLocalPlanner.html#a96e21935e453518a9760e78cc722b271">00255</a>         <span class="keywordtype">int</span>             <a class="code" href="classLocalPlanner.html#a96e21935e453518a9760e78cc722b271">platform_</a>;              
<a name="l00256"></a><a class="code" href="classLocalPlanner.html#aedc2482876eaeb5f9c33f24f90fa827d">00256</a>         <span class="keywordtype">bool</span>    <a class="code" href="classLocalPlanner.html#aedc2482876eaeb5f9c33f24f90fa827d" title="flat marking what platform we&#39;re running on">should_plan_</a>;   
<a name="l00257"></a>00257 
<a name="l00258"></a><a class="code" href="classLocalPlanner.html#a5c93ab12f5722cfe56f363a00fa1d781">00258</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a5c93ab12f5722cfe56f363a00fa1d781" title="Flag for signaling if the local planner should be running.">goal_weight_</a>;   
<a name="l00259"></a><a class="code" href="classLocalPlanner.html#a6f668b354b481784a886b7f935f9bef4">00259</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a6f668b354b481784a886b7f935f9bef4" title="weighting factor to bias tentacle selection towards the goal point">trav_weight_</a>;   
<a name="l00260"></a><a class="code" href="classLocalPlanner.html#ab54f1e68f375ec0dbf96eca2c6f0a14d">00260</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#ab54f1e68f375ec0dbf96eca2c6f0a14d" title="weighting factor to bias tentacle selection away from previously traversed points">diff_weight_</a>;   
<a name="l00261"></a><a class="code" href="classLocalPlanner.html#a633f5fdf6a570395d59e02f1f714fba2">00261</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a633f5fdf6a570395d59e02f1f714fba2" title="weighting factor to bias tentacle selection away from difficult terrain">unkn_weight_</a>;   
<a name="l00262"></a><a class="code" href="classLocalPlanner.html#a8341d0c7a16284070852ae4b31d83929">00262</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a8341d0c7a16284070852ae4b31d83929" title="weighting factor to bias tentacle selection towards unknown terrain">x_dim_</a>;         
<a name="l00263"></a><a class="code" href="classLocalPlanner.html#abc0f1d506fc102fdc2802f55b654b613">00263</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#abc0f1d506fc102fdc2802f55b654b613" title="x dimension of the occupancy grid to use, in real units">y_dim_</a>;         
<a name="l00264"></a><a class="code" href="classLocalPlanner.html#a5a5e8a299d488da417fa3baea4b9b785">00264</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a5a5e8a299d488da417fa3baea4b9b785" title="y dimension of the occupancy grid to use, in real units">z_dim_</a>;         
<a name="l00265"></a><a class="code" href="classLocalPlanner.html#a8077cef3936c2691936388ee28f0ff9d">00265</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a8077cef3936c2691936388ee28f0ff9d" title="z dimension of the occupancy grid to use, in real units">res_</a>;           
<a name="l00266"></a><a class="code" href="classLocalPlanner.html#a054b4da9ce90665b04a7e7b609672b5a">00266</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a054b4da9ce90665b04a7e7b609672b5a" title="resolution the occupancy grid to use, in real units per grid unit">current_vel_</a>;   
<a name="l00267"></a><a class="code" href="classLocalPlanner.html#a2c383a3a38dc3666db5d06b61b14fd1d">00267</a>         <span class="keywordtype">double</span>  <a class="code" href="classLocalPlanner.html#a2c383a3a38dc3666db5d06b61b14fd1d" title="Current Velocity of the Platform.">current_rad_</a>;   
<a name="l00268"></a><a class="code" href="classLocalPlanner.html#aa5ea5044555101033c5b1795c5f9cf3f">00268</a>         ros::NodeHandle <a class="code" href="classLocalPlanner.html#aa5ea5044555101033c5b1795c5f9cf3f" title="Current Radius followed by the Platform.">nh_</a>;    
<a name="l00269"></a><a class="code" href="classLocalPlanner.html#aa2d89e1db5100cee7f0b8b6db59411ac">00269</a>         std::string     <a class="code" href="classLocalPlanner.html#aa2d89e1db5100cee7f0b8b6db59411ac" title="Node handle for publishing/subscribing to topics.">v_action_topic_</a>;                
<a name="l00270"></a><a class="code" href="classLocalPlanner.html#ab7b4031d03a074a4fb683606ee87cadc">00270</a>         std::string <a class="code" href="classLocalPlanner.html#ab7b4031d03a074a4fb683606ee87cadc" title="Actionlib topic name to send velocity commands over.">pc_topic_</a>;                  
<a name="l00271"></a><a class="code" href="classLocalPlanner.html#ad8e9ea5ce805a9c92b054353b6fe00d7">00271</a>         <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a>       <a class="code" href="classLocalPlanner.html#ad8e9ea5ce805a9c92b054353b6fe00d7" title="topic name of the ROS topic to receive new occupancy grid data over">origin_</a>;        
<a name="l00272"></a><a class="code" href="classLocalPlanner.html#ae8cae1e72eacad73b0ec423f0352c887">00272</a>         <a class="code" href="namespaceoryx__path__planning.html#a31e90111442c09b8e17c0bc6a3eb98e7" title="Typedef to allow for convenient sharing of a TentacleGenerator via pointer.">TentacleGeneratorPtr</a> <a class="code" href="classLocalPlanner.html#ae8cae1e72eacad73b0ec423f0352c887" title="The origin to use for the occupancy grids.">tentacles_</a>;        
<a name="l00273"></a><a class="code" href="classLocalPlanner.html#a5a190e043aa46ffe4d459cf1efbd4d78">00273</a>         ros::Subscriber         <a class="code" href="classLocalPlanner.html#a5a190e043aa46ffe4d459cf1efbd4d78" title="Pointer to the tentacle generator which contains the tentacles to use for planning.">pc_sub_</a>;                
<a name="l00274"></a><a class="code" href="classLocalPlanner.html#ac5be4b2d7e3ba97acd1baad8378e5b84">00274</a>         ros::Subscriber         <a class="code" href="classLocalPlanner.html#ac5be4b2d7e3ba97acd1baad8378e5b84" title="Subscriber to the ROS topic to receive new occupancy grid data over.">stop_sub_</a>;      
<a name="l00275"></a><a class="code" href="classLocalPlanner.html#a05929c79a45501fa680b29ac47b7f456">00275</a>         ros::Publisher          <a class="code" href="classLocalPlanner.html#a05929c79a45501fa680b29ac47b7f456" title="Subscriber to the ROS topic to receive the software stop message.">vel_pub_</a>;       
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="classLocalPlanner.html#a07707d65004db2f3812fbe6e14bbdaa1">00277</a>         boost::circular_buffer&lt;OccupancyGrid &gt; <a class="code" href="classLocalPlanner.html#a07707d65004db2f3812fbe6e14bbdaa1" title="Publisher for Twist messages to a platform that takes them.">occupancy_buffer_</a>;       
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="classLocalPlanner.html#a4f4e9a8c0a8121240f3604b90835f2df">00279</a>         actionlib::SimpleActionClient&lt;oryx_drive_controller::VelocityCommandAction&gt; <a class="code" href="classLocalPlanner.html#a4f4e9a8c0a8121240f3604b90835f2df" title="Buffer to store received OccupancyGrid data.">v_client_</a>;  
<a name="l00280"></a>00280 
<a name="l00286"></a><a class="code" href="classLocalPlanner.html#a80d9e4db91908f43ed4c062b64bc026a">00286</a>         <span class="keywordtype">void</span> <a class="code" href="classLocalPlanner.html#a80d9e4db91908f43ed4c062b64bc026a" title="The actionlib client to set velocity command messages to the base platform with.">stopCB</a>(<span class="keyword">const</span> oryx_msgs::SoftwareStopConstPtr&amp; message){
<a name="l00287"></a>00287                 <span class="comment">//Need to flip as message is true when should stop</span>
<a name="l00288"></a>00288                 this-&gt;should_plan_ = !message-&gt;stop;
<a name="l00289"></a>00289                 ROS_WARN(<span class="stringliteral">&quot;Oryx Local Path Planner Received A Software Stop Message [%s]: %s&quot;</span>,(message-&gt;stop)?<span class="stringliteral">&quot;Stop&quot;</span>:<span class="stringliteral">&quot;Go&quot;</span>, message-&gt;message.c_str());
<a name="l00290"></a>00290                 <span class="comment">//If we were told to stop, clear the buffer so we don&#39;t process stale data at wakeup</span>
<a name="l00291"></a>00291                 <span class="keywordflow">if</span>(!this-&gt;should_plan_)this-&gt;occupancy_buffer_.clear();
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293 
<a name="l00302"></a><a class="code" href="classLocalPlanner.html#af5e5b35b455967277af17dcb6b09fb3b">00302</a>         <span class="keywordtype">void</span> <a class="code" href="classLocalPlanner.html#af5e5b35b455967277af17dcb6b09fb3b" title="Callback for processing new point cloud data.">pcCB</a>(<span class="keyword">const</span> oryx_path_planning::OccupancyGridMsgConstPtr&amp; message){
<a name="l00303"></a>00303                 <span class="comment">//To prevent processing of stale data, ignore anything received while we shouldn&#39;t be planning</span>
<a name="l00304"></a>00304                 <span class="keywordflow">if</span>(this-&gt;should_plan_)
<a name="l00305"></a>00305                 {
<a name="l00306"></a>00306                         ROS_INFO(<span class="stringliteral">&quot;I Got new Occupancy Grid Data!&quot;</span>);
<a name="l00307"></a>00307                         <a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html" title="Class which represents an Occupancy Grid that contains data on the robot&#39;s local frame.">OccupancyGrid</a> recievedGrid(*message);
<a name="l00308"></a>00308                         ROS_INFO(<span class="stringliteral">&quot;Grid Processed...&quot;</span>);
<a name="l00309"></a>00309                         ROS_INFO(<span class="stringliteral">&quot;Callback got the grid:\n%s&quot;</span>, recievedGrid.<a class="code" href="classoryx__path__planning_1_1OccupancyGrid.html#a8753688af5e3a1a1f1b00453c96da801" title="Generates a string representation of a slice of the Occupancy Grid.">toString</a>(0,0)-&gt;c_str());
<a name="l00310"></a>00310                         this-&gt;occupancy_buffer_.push_back(recievedGrid);
<a name="l00311"></a>00311                 }
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313 
<a name="l00319"></a><a class="code" href="classLocalPlanner.html#a6063c84b14ab9fbe5aa8ec6ff4d2feeb">00319</a>         <span class="keywordtype">void</span> sendVelCom(<span class="keywordtype">double</span> velocity, <span class="keywordtype">double</span> radius)
<a name="l00320"></a>00320         {
<a name="l00321"></a>00321                 <span class="keywordflow">switch</span> (this-&gt;platform_)
<a name="l00322"></a>00322                 {
<a name="l00323"></a>00323                 <span class="keywordflow">case</span> 0:
<a name="l00324"></a>00324                         send(velocity, radius);
<a name="l00325"></a>00325                         <span class="keywordflow">break</span>;
<a name="l00326"></a>00326                 <span class="keywordflow">case</span> 1:
<a name="l00327"></a>00327                         twist(velocity, velocity/radius);
<a name="l00328"></a>00328                         <span class="keywordflow">break</span>;
<a name="l00329"></a>00329                 <span class="keywordflow">default</span>:
<a name="l00330"></a>00330                         <span class="keywordflow">break</span>;
<a name="l00331"></a>00331                 }
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333 
<a name="l00339"></a><a class="code" href="classLocalPlanner.html#aea03c48eeabeb399d57fedf6d035f722">00339</a>         <span class="keywordtype">void</span> twist(<span class="keywordtype">double</span> x_dot, <span class="keywordtype">double</span> omega)
<a name="l00340"></a>00340         {
<a name="l00341"></a>00341                 geometry_msgs::Twist message;
<a name="l00342"></a>00342                 message.linear.x  = 0;
<a name="l00343"></a>00343                 message.angular.z = omega;
<a name="l00344"></a>00344                 this-&gt;vel_pub_.publish(message);
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346 
<a name="l00353"></a><a class="code" href="classLocalPlanner.html#a7ff5ca95ed25c73a15323db998ef3278">00353</a>         <span class="keywordtype">void</span> send(<span class="keywordtype">double</span> velocity, <span class="keywordtype">double</span> radius)
<a name="l00354"></a>00354         {
<a name="l00355"></a>00355                 oryx_drive_controller::VelocityCommandGoal newGoal;
<a name="l00356"></a>00356                 newGoal.velocity        = velocity;
<a name="l00357"></a>00357                 newGoal.radius          = radius;
<a name="l00358"></a>00358                 <span class="comment">//Once again, have to used boost::bind because you are inside a class</span>
<a name="l00359"></a>00359                 v_client_.sendGoal(newGoal, boost::bind(&amp;<a class="code" href="classLocalPlanner.html#a716bff1f3f435ee76a11e64c58167606" title="Callback for handling the result from the velocity controller.">LocalPlanner::doneCb</a>, <span class="keyword">this</span>, _1, _2),
<a name="l00360"></a>00360                                 boost::bind(&amp;<a class="code" href="classLocalPlanner.html#a7124072c7a21bbad98349274cf25c0d5" title="Callback for processing the response that a velocity goal went active.">LocalPlanner::activeCb</a>, <span class="keyword">this</span>),
<a name="l00361"></a>00361                                 boost::bind(&amp;<a class="code" href="classLocalPlanner.html#ad578d2ad2eebf7753f421f65360a9990" title="Callback for handling velocity controller feedback.">LocalPlanner::feedbackCb</a>, <span class="keyword">this</span>, _1));
<a name="l00362"></a>00362         }
<a name="l00363"></a>00363 
<a name="l00370"></a><a class="code" href="classLocalPlanner.html#a716bff1f3f435ee76a11e64c58167606">00370</a>         <span class="keywordtype">void</span> doneCb(<span class="keyword">const</span> actionlib::SimpleClientGoalState&amp; state,
<a name="l00371"></a>00371                         <span class="keyword">const</span> oryx_drive_controller::VelocityCommandResultConstPtr&amp; result)
<a name="l00372"></a>00372         {
<a name="l00373"></a>00373                 ROS_DEBUG(<span class="stringliteral">&quot;Finished in state [%s]&quot;</span>, state.toString().c_str());
<a name="l00374"></a>00374                 ROS_DEBUG(<span class="stringliteral">&quot;Result: %s&quot;</span>, (result-&gt;success)?<span class="stringliteral">&quot;Successful&quot;</span>:<span class="stringliteral">&quot;Unsuccessful&quot;</span>);
<a name="l00375"></a>00375         };
<a name="l00376"></a>00376 
<a name="l00381"></a><a class="code" href="classLocalPlanner.html#a7124072c7a21bbad98349274cf25c0d5">00381</a>         <span class="keywordtype">void</span> activeCb()
<a name="l00382"></a>00382         {
<a name="l00383"></a>00383                 ROS_DEBUG(<span class="stringliteral">&quot;Platform Received Velocity Goal&quot;</span>);
<a name="l00384"></a>00384         };
<a name="l00385"></a>00385 
<a name="l00391"></a><a class="code" href="classLocalPlanner.html#ad578d2ad2eebf7753f421f65360a9990">00391</a>         <span class="keywordtype">void</span> feedbackCb(<span class="keyword">const</span> oryx_drive_controller::VelocityCommandFeedbackConstPtr&amp; feedback)
<a name="l00392"></a>00392         {
<a name="l00393"></a>00393                 this-&gt;current_vel_ = feedback-&gt;velocity;
<a name="l00394"></a>00394                 this-&gt;current_rad_ = feedback-&gt;omega;
<a name="l00395"></a>00395         };
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 };
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">//*********************** NODE IMPLEMENTATION ******************************//</span>
<a name="l00400"></a>00400 
<a name="l00401"></a><a class="code" href="oryx__local__planner_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">00401</a> <span class="keywordtype">int</span> <a class="code" href="occupancy__generator_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
<a name="l00402"></a>00402         ros::init(argc, argv, <span class="stringliteral">&quot;oryx_base_planner&quot;</span>);
<a name="l00403"></a>00403         ros::NodeHandle nh;
<a name="l00404"></a>00404         ros::NodeHandle p_nh(<span class="stringliteral">&quot;~&quot;</span>);
<a name="l00405"></a>00405         <span class="comment">//Default Parameter Values</span>
<a name="l00406"></a>00406         <span class="comment">//*****************Communication Parameters*******************//</span>
<a name="l00407"></a>00407         std::string v_com_top(<span class="stringliteral">&quot;velocity_command_topic&quot;</span>);
<a name="l00408"></a>00408         <span class="comment">//std::string t_com_top(&quot;translate_command_topic&quot;);</span>
<a name="l00409"></a>00409         std::string pc_top(<span class="stringliteral">&quot;occupancy_point_cloud_topic&quot;</span>);
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         <span class="comment">//*****************Configuration Parameters*******************//</span>
<a name="l00412"></a>00412         <span class="comment">//The platform that the local planner is running on</span>
<a name="l00413"></a>00413         std::string p_platform(<span class="stringliteral">&quot;platform&quot;</span>);
<a name="l00414"></a>00414         <span class="keywordtype">int</span> platform = 0;
<a name="l00415"></a>00415         std::string platform_message(<span class="stringliteral">&quot;Oryx&quot;</span>);
<a name="l00416"></a>00416 
<a name="l00417"></a>00417         <span class="comment">//Minimum update rate expected of occupancy grid</span>
<a name="l00418"></a>00418         std::string p_up_rate(<span class="stringliteral">&quot;occupancy/update_rate&quot;</span>);
<a name="l00419"></a>00419         <span class="keywordtype">double</span> update_rate = 0.2;
<a name="l00420"></a>00420         std::string up_rate_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00421"></a>00421         up_rate_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(update_rate);
<a name="l00422"></a>00422         up_rate_msg+=<span class="stringliteral">&quot;s&quot;</span>;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         <span class="comment">//x dimension of occupancy grid</span>
<a name="l00425"></a>00425         std::string p_x_dim(<span class="stringliteral">&quot;occupancy/x_dimension&quot;</span>);
<a name="l00426"></a>00426         <span class="keywordtype">double</span> x_dim = 200;
<a name="l00427"></a>00427         std::string x_dim_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00428"></a>00428         x_dim_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(x_dim);
<a name="l00429"></a>00429         x_dim_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="comment">//y dimension of occupancy grid</span>
<a name="l00432"></a>00432         std::string p_y_dim(<span class="stringliteral">&quot;occupancy/y_dimension&quot;</span>);
<a name="l00433"></a>00433         <span class="keywordtype">double</span> y_dim = 200;
<a name="l00434"></a>00434         std::string y_dim_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00435"></a>00435         y_dim_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(y_dim);
<a name="l00436"></a>00436         y_dim_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         <span class="comment">//z dimension of occupancy grid</span>
<a name="l00439"></a>00439         std::string p_z_dim(<span class="stringliteral">&quot;occupancy/z_dimension&quot;</span>);
<a name="l00440"></a>00440         <span class="keywordtype">double</span> z_dim = 0;
<a name="l00441"></a>00441         std::string z_dim_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00442"></a>00442         z_dim_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(z_dim);
<a name="l00443"></a>00443         z_dim_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445         <span class="comment">//resolution occupancy grid</span>
<a name="l00446"></a>00446         std::string p_res(<span class="stringliteral">&quot;occupancy/grid_resolution&quot;</span>);
<a name="l00447"></a>00447         <span class="keywordtype">double</span> res = .01;
<a name="l00448"></a>00448         std::string p_res_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00449"></a>00449         p_res_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(res);
<a name="l00450"></a>00450         p_res_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452         <span class="comment">//x coord of the origin of the occupancy grids</span>
<a name="l00453"></a>00453         std::string p_x_ori(<span class="stringliteral">&quot;occupancy/x_origin&quot;</span>);
<a name="l00454"></a>00454         <span class="keywordtype">double</span> x_ori = 0;
<a name="l00455"></a>00455         std::string p_x_ori_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00456"></a>00456         p_x_ori_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(x_ori);
<a name="l00457"></a>00457         p_x_ori_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="comment">//z coord of the origin of the occupancy grids</span>
<a name="l00460"></a>00460         std::string p_z_ori(<span class="stringliteral">&quot;occupancy/z_origin&quot;</span>);
<a name="l00461"></a>00461         <span class="keywordtype">double</span> z_ori = 0;
<a name="l00462"></a>00462         std::string p_z_ori_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00463"></a>00463         p_z_ori_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(z_ori);
<a name="l00464"></a>00464         p_z_ori_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466         <span class="comment">//y coord of the origin of the occupancy grids</span>
<a name="l00467"></a>00467         std::string p_y_ori(<span class="stringliteral">&quot;occupancy/y_origin&quot;</span>);
<a name="l00468"></a>00468         <span class="keywordtype">double</span> y_ori = y_dim/2;
<a name="l00469"></a>00469         std::string p_y_ori_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00470"></a>00470         p_y_ori_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(y_ori);
<a name="l00471"></a>00471         p_y_ori_msg+=<span class="stringliteral">&quot;m&quot;</span>;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         <span class="comment">//number of tentacles per speed set</span>
<a name="l00475"></a>00475         std::string p_num_tent(<span class="stringliteral">&quot;tentacles/number&quot;</span>);
<a name="l00476"></a>00476         <span class="keywordtype">int</span> num_tent = 81;
<a name="l00477"></a>00477         std::string p_num_tent_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00478"></a>00478         p_num_tent_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(num_tent);
<a name="l00479"></a>00479         p_num_tent_msg+=<span class="stringliteral">&quot; Tentacles&quot;</span>;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481         <span class="comment">//Exponential Factor to use for generating seed radii</span>
<a name="l00482"></a>00482         std::string p_exp_fact(<span class="stringliteral">&quot;tentacles/exp_factor&quot;</span>);
<a name="l00483"></a>00483         <span class="keywordtype">double</span> exp_fact = 1.15;
<a name="l00484"></a>00484         std::string p_exp_fact_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00485"></a>00485         p_exp_fact_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(exp_fact);
<a name="l00486"></a>00486 
<a name="l00487"></a>00487         <span class="comment">//number of tentacles per speed set</span>
<a name="l00488"></a>00488         std::string p_num_speed_set(<span class="stringliteral">&quot;speed_set/number&quot;</span>);
<a name="l00489"></a>00489         <span class="keywordtype">int</span> num_speed_set = 15;
<a name="l00490"></a>00490         std::string p_numSpeedSet_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00491"></a>00491         p_numSpeedSet_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(num_speed_set);
<a name="l00492"></a>00492         p_numSpeedSet_msg+= <span class="stringliteral">&quot; Speed Sets&quot;</span>;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         <span class="comment">//Max Speed</span>
<a name="l00495"></a>00495         std::string p_max_speed(<span class="stringliteral">&quot;speed_set/max_speed&quot;</span>);
<a name="l00496"></a>00496         <span class="keywordtype">double</span> max_speed = 1;
<a name="l00497"></a>00497         std::string p_max_speed_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00498"></a>00498         p_max_speed_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(max_speed);
<a name="l00499"></a>00499         p_max_speed_msg+=<span class="stringliteral">&quot;m/s&quot;</span>;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         <span class="comment">//Min Speed</span>
<a name="l00502"></a>00502         std::string p_min_speed(<span class="stringliteral">&quot;speed_set/min_speed&quot;</span>);
<a name="l00503"></a>00503         <span class="keywordtype">double</span> min_speed = 1;
<a name="l00504"></a>00504         std::string p_min_speed_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00505"></a>00505         p_min_speed_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(min_speed);
<a name="l00506"></a>00506         p_min_speed_msg+=<span class="stringliteral">&quot;m/s&quot;</span>;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         <span class="comment">//Goal Weight</span>
<a name="l00509"></a>00509         std::string p_goal_weight(<span class="stringliteral">&quot;goal_weight&quot;</span>);
<a name="l00510"></a>00510         <span class="keywordtype">double</span> goal_weight = 2;
<a name="l00511"></a>00511         std::string p_goal_weight_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00512"></a>00512         p_goal_weight_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(goal_weight);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="comment">//Traversed Weight</span>
<a name="l00515"></a>00515         std::string p_trav_weight(<span class="stringliteral">&quot;traversed_weight&quot;</span>);
<a name="l00516"></a>00516         <span class="keywordtype">double</span> trav_weight = 0.1;
<a name="l00517"></a>00517         std::string p_trav_weight_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00518"></a>00518         p_trav_weight_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(trav_weight);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="comment">//Difficulty Weight</span>
<a name="l00521"></a>00521         std::string p_diff_weight(<span class="stringliteral">&quot;difficult_weight&quot;</span>);
<a name="l00522"></a>00522         <span class="keywordtype">double</span> diff_weight = 0.1;
<a name="l00523"></a>00523         std::string p_diff_weight_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00524"></a>00524         p_diff_weight_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(diff_weight);
<a name="l00525"></a>00525 
<a name="l00526"></a>00526         <span class="comment">//Unkown Terrain Weight</span>
<a name="l00527"></a>00527         std::string p_unkn_weight(<span class="stringliteral">&quot;unknown_weight&quot;</span>);
<a name="l00528"></a>00528         <span class="keywordtype">double</span> unkn_weight = 0.1;
<a name="l00529"></a>00529         std::string p_unkn_weight_msg(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00530"></a>00530         p_unkn_weight_msg+= boost::lexical_cast&lt;<span class="keywordtype">double</span>&gt;(unkn_weight);
<a name="l00531"></a>00531 
<a name="l00532"></a>00532         <span class="comment">//Node Information Printout</span>
<a name="l00533"></a>00533         ROS_INFO(<span class="stringliteral">&quot;Starting Up Oryx Local Planner Version %d.%d.%d&quot;</span>, oryx_path_planner_VERSION_MAJOR, oryx_path_planner_VERSION_MINOR, oryx_path_planner_VERSION_BUILD);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <span class="comment">//Get Private Parameters</span>
<a name="l00536"></a>00536         <span class="keywordflow">if</span>(!p_nh.getParam(p_platform, platform))
<a name="l00537"></a>00537         {
<a name="l00538"></a>00538                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_platform, platform_message);
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540         <span class="keywordflow">else</span>
<a name="l00541"></a>00541         {
<a name="l00542"></a>00542                 <span class="keywordflow">switch</span>(platform)
<a name="l00543"></a>00543                 {
<a name="l00544"></a>00544                 <span class="keywordflow">case</span> 0:
<a name="l00545"></a>00545                         platform_message = <span class="stringliteral">&quot;Oryx&quot;</span>;
<a name="l00546"></a>00546                         <span class="keywordflow">break</span>;
<a name="l00547"></a>00547                 <span class="keywordflow">case</span> 1:
<a name="l00548"></a>00548                         platform_message = <span class="stringliteral">&quot;Husky A200&quot;</span>;
<a name="l00549"></a>00549                         <span class="keywordflow">break</span>;
<a name="l00550"></a>00550                 <span class="keywordflow">default</span>:
<a name="l00551"></a>00551                         platform_message = <span class="stringliteral">&quot;Unkown, defaulting to Oryx&quot;</span>;
<a name="l00552"></a>00552                         <span class="keywordflow">break</span>;
<a name="l00553"></a>00553                 }
<a name="l00554"></a>00554                 ROS_INFO_STREAM(<span class="stringliteral">&quot;Running on Platform: &quot;</span>&lt;&lt;platform_message);
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556         <span class="keywordflow">if</span>(!p_nh.getParam(v_com_top,v_com_top))         <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(v_com_top,   v_com_top);
<a name="l00557"></a>00557         <span class="keywordflow">if</span>(!p_nh.getParam(pc_top,       pc_top))                <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(pc_top,              pc_top);
<a name="l00558"></a>00558         <span class="keywordflow">if</span>(!p_nh.getParam(p_goal_weight,        goal_weight))<a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_goal_weight,p_goal_weight_msg);
<a name="l00559"></a>00559         <span class="keywordflow">if</span>(!p_nh.getParam(p_trav_weight,        trav_weight))<a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_trav_weight,p_trav_weight_msg);
<a name="l00560"></a>00560         <span class="keywordflow">if</span>(!p_nh.getParam(p_diff_weight,        diff_weight))<a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_diff_weight,p_diff_weight_msg);
<a name="l00561"></a>00561         <span class="keywordflow">if</span>(!p_nh.getParam(p_unkn_weight,        unkn_weight))<a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_unkn_weight,p_unkn_weight_msg);
<a name="l00562"></a>00562         <span class="comment">//Get Public Parameters</span>
<a name="l00563"></a>00563         <span class="keywordflow">if</span>(!nh.getParam(p_up_rate,      update_rate))   <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_up_rate,   up_rate_msg);
<a name="l00564"></a>00564         <span class="keywordflow">if</span>(!nh.getParam(p_x_dim,        x_dim))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_x_dim,             x_dim_msg);
<a name="l00565"></a>00565         <span class="keywordflow">if</span>(!nh.getParam(p_y_dim,        y_dim))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_y_dim,             y_dim_msg);
<a name="l00566"></a>00566         <span class="keywordflow">if</span>(!nh.getParam(p_z_dim,        z_dim))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_z_dim,             z_dim_msg);
<a name="l00567"></a>00567         <span class="keywordflow">if</span>(!nh.getParam(p_x_ori,        x_ori))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_x_ori,             p_x_ori_msg);
<a name="l00568"></a>00568         <span class="keywordflow">if</span>(!nh.getParam(p_y_ori,        y_ori))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_y_ori,             p_y_ori_msg);
<a name="l00569"></a>00569         <span class="keywordflow">if</span>(!nh.getParam(p_z_ori,        z_ori))                 <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_z_ori,             p_z_ori_msg);
<a name="l00570"></a>00570         <span class="keywordflow">if</span>(!nh.getParam(p_res,          res))                   <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_res,               p_res_msg);
<a name="l00571"></a>00571         <span class="keywordflow">if</span>(!nh.getParam(p_num_tent,     num_tent))              <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_num_tent,  p_num_tent_msg);
<a name="l00572"></a>00572         <span class="keywordflow">if</span>(!nh.getParam(p_exp_fact,     exp_fact))              <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_exp_fact,  p_exp_fact_msg);
<a name="l00573"></a>00573         <span class="keywordflow">if</span>(!nh.getParam(p_num_speed_set, num_speed_set))<a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_num_speed_set,     p_numSpeedSet_msg);
<a name="l00574"></a>00574         <span class="keywordflow">if</span>(!nh.getParam(p_max_speed,    max_speed))             <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_max_speed, p_max_speed_msg);
<a name="l00575"></a>00575         <span class="keywordflow">if</span>(!nh.getParam(p_min_speed,    min_speed))             <a class="code" href="occupancy__generator_8cpp.html#a421d1715a55e4aa436fffe89c1e31248" title="Macro for printing out warning messages if default parameters are used.">PARAM_WARN</a>(p_min_speed, p_min_speed_msg);
<a name="l00576"></a>00576 
<a name="l00577"></a>00577         <span class="comment">//Set up Tentacles</span>
<a name="l00578"></a>00578         ROS_INFO(<span class="stringliteral">&quot;Generating Tentacles...&quot;</span>);
<a name="l00579"></a>00579         boost::shared_ptr&lt;TentacleGenerator&gt; tentacle_ptr(<span class="keyword">new</span> <a class="code" href="classoryx__path__planning_1_1TentacleGenerator.html" title="Generates and manages tentacle data.">oryx_path_planning::TentacleGenerator</a> (min_speed, max_speed, num_speed_set, num_tent, exp_fact, res, x_dim, y_dim/2));
<a name="l00580"></a>00580         ROS_INFO(<span class="stringliteral">&quot;Tentacles Generated!&quot;</span>);
<a name="l00581"></a>00581         <span class="comment">//Set up client to Drive Controller</span>
<a name="l00582"></a>00582         <span class="keywordflow">try</span>
<a name="l00583"></a>00583         {
<a name="l00584"></a>00584                 <a class="code" href="namespaceoryx__path__planning.html#ab6b2cd9ece5379387e19040263872757" title="Typedef to allow for easier to read code.">oryx_path_planning::Point</a> origin;
<a name="l00585"></a>00585                 origin.x=x_ori;
<a name="l00586"></a>00586                 origin.y=y_ori;
<a name="l00587"></a>00587                 origin.z=z_ori;
<a name="l00588"></a>00588                 PRINT_POINT(<span class="stringliteral">&quot;Origin Point&quot;</span>, origin);
<a name="l00589"></a>00589                 <a class="code" href="classLocalPlanner.html" title="Class which does the actual work of local path planning and sending commands to base.">LocalPlanner</a> planner(platform, goal_weight, trav_weight, diff_weight, unkn_weight, x_dim, y_dim, z_dim, res, origin, v_com_top,  pc_top, tentacle_ptr);
<a name="l00590"></a>00590                 planner.<a class="code" href="classLocalPlanner.html#a5e5de9ddb98611ea99329b8ef295c7c4" title="Does the actual work of implementing the Driving with Tentacles algorithm.">doPlanning</a>();
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592         <span class="keywordflow">catch</span>(std::exception&amp; e)
<a name="l00593"></a>00593         {
<a name="l00594"></a>00594                 ROS_FATAL(<span class="stringliteral">&quot;%s, %s&quot;</span>,e.what(), <span class="stringliteral">&quot;Shutting Down&quot;</span>);
<a name="l00595"></a>00595                 ros::shutdown();
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="comment">//};</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://ros.org/wiki/oryx_path_planning">oryx_path_planning</a><br />
Author(s): </br />
<small>autogenerated on Sun Jan 27 2013 20:34:31</small>
</div>
</body>
</html>
